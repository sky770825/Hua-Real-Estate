# 📊 匯入出席統計說明

## 🎯 功能概述

此功能可以將其他系統的出席統計 CSV 檔案匯入到目前的專案中，自動創建會議和簽到記錄。

## 📋 CSV 檔案格式

### 標準格式
```csv
會員編號,姓名,總會議數,出席次數,遲到次數,代理出席,缺席次數,生命值
1,洪怡芳Ruby,20,19,0,1,1,HP 90/120
2,何青馨Eva,20,20,0,0,0,HP 120/120
```

### 欄位說明
- **會員編號**: 會員的 ID（必須是數字）
- **姓名**: 會員姓名
- **總會議數**: 該會員參與的總會議數
- **出席次數**: 正常出席的次數
- **遲到次數**: 遲到的次數
- **代理出席**: 代理出席的次數（目前未使用）
- **缺席次數**: 缺席的次數
- **生命值**: 遊戲化指標（目前未使用）

## 🚀 使用步驟

### 1. 準備 CSV 檔案
確保您的 CSV 檔案符合上述格式，檔案名稱建議包含日期範圍：
```
出席統計_2025-07-18_2026-01-14.csv
```

### 2. 解鎖開發者功能
1. 前往「系統設定」頁面
2. 點擊「解鎖開發者功能」
3. 輸入密碼：`888`

### 3. 匯入數據
1. 在「資料匯出與匯入」區塊中
2. 找到「📊 匯入出席統計 CSV（從其他系統）」
3. 點擊「選擇檔案」按鈕
4. 選擇您的 CSV 檔案

### 4. 確認日期範圍
- 如果檔案名稱包含日期範圍（格式：`出席統計_YYYY-MM-DD_YYYY-MM-DD.csv`），系統會自動提取
- 如果檔案名稱沒有日期，系統會提示您輸入開始和結束日期

### 5. 確認匯入
系統會顯示確認對話框，確認後開始匯入：
- 創建所有會議（根據日期範圍內的所有週四）
- 為每位會員創建簽到記錄（根據出席、遲到、缺席次數）

## ⚙️ 匯入邏輯

### 會議創建
- 系統會根據日期範圍找出所有週四
- 根據 CSV 中的「總會議數」決定創建多少個會議
- 所有會議狀態設為「已完成」

### 簽到記錄創建
- 為每位會員在每個會議創建簽到記錄
- 根據統計數據分配狀態：
  1. 優先分配「缺席」
  2. 然後分配「遲到」
  3. 最後分配「出席」
- 簽到時間設為會議當天的 19:00

## ⚠️ 注意事項

### 1. 資料覆蓋
- 如果會議已存在，會更新狀態為「已完成」
- 如果簽到記錄已存在，會更新狀態
- **建議在匯入前先備份現有數據**

### 2. 日期範圍
- 系統會根據日期範圍找出所有週四
- 確保日期範圍正確，否則可能創建錯誤的會議

### 3. 會員匹配
- 系統會根據「會員編號」匹配會員
- 如果會員不存在，該會員的簽到記錄會創建失敗（但不會影響其他會員）

### 4. 數據驗證
- 系統會驗證 CSV 格式
- 如果格式錯誤，會顯示錯誤訊息

## 📊 匯入結果

匯入完成後，系統會顯示：
- ✅ 創建的會議數量
- ✅ 創建的簽到記錄數量
- ✅ 處理的會員數量
- ⚠️ 如果有錯誤，會顯示錯誤列表

## 🔍 驗證匯入結果

匯入完成後，建議：

1. **檢查會議列表**
   - 前往「會議管理」標籤
   - 確認所有會議都已創建
   - 確認會議日期都是週四

2. **檢查簽到記錄**
   - 選擇一個會議日期
   - 查看簽到記錄是否正確
   - 確認出席、遲到、缺席的數量符合 CSV 數據

3. **檢查統計報表**
   - 前往「統計報表」標籤
   - 查看會員的出席統計
   - 確認數據與 CSV 一致

## 🆘 常見問題

### Q: 匯入後數據不正確？
**A**: 
1. 檢查 CSV 檔案格式是否正確
2. 確認日期範圍是否正確
3. 檢查會員編號是否匹配

### Q: 部分會員的簽到記錄沒有創建？
**A**: 
- 可能是會員不存在（會員編號不匹配）
- 查看匯入結果的錯誤列表

### Q: 會議日期不對？
**A**: 
- 確認日期範圍是否正確
- 系統只會創建週四的會議
- 如果日期範圍內沒有足夠的週四，會創建較少的會議

### Q: 如何重新匯入？
**A**: 
1. 先清除現有的簽到記錄（系統設定 → 清除簽到記錄，需開發者權限）
2. 刪除相關的會議
3. 重新執行匯入

## 📝 範例

### CSV 檔案範例
```csv
會員編號,姓名,總會議數,出席次數,遲到次數,代理出席,缺席次數,生命值
1,洪怡芳Ruby,20,19,0,1,1,HP 90/120
2,何青馨Eva,20,20,0,0,0,HP 120/120
3,黃懷瑩Hannah,20,18,1,0,2,HP 60/120
```

### 匯入結果範例
```
匯入成功！
會議：20 個
簽到記錄：60 筆
會員：3 位
```

## 🔄 與其他功能的整合

匯入完成後：
- ✅ 會議會出現在「會議管理」中
- ✅ 簽到記錄會出現在「出席管理」中
- ✅ 統計數據會出現在「統計報表」中
- ✅ 所有相關快取會自動清除

---

**最後更新**: 2026-01-16
**版本**: 1.0.0
